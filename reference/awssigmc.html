<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate noise variance for multicoil MR systems — awssigmc • dti</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate noise variance for multicoil MR systems — awssigmc" />
<meta property="og:description" content="The distribution of image intensity values \(S_i\) divided by the noise standard deviation in \(K\)-space \(\sigma\) 
    in dMRI experiments is assumed
    to follow a non-central chi-distribution with \(2L\) degrees of freedom and noncentrality parameter \(\eta\), where \(L\) refers to the number of receiver 
    coils in the system and \(\sigma \eta\) is the signal of interest. This is an idealization in the sense that 
    each coil is assumed to have the same contribution at each location. For realistic modeling \(L\) should 
    be a locally smooth function in voxel space that reflects the varying local influence of the receiver coils in the
    the reconstruction algorithm used.  
The functions assume \(L\) to be known and estimate either a local 
    (function awslsigmc) or global ( function awssigmc) 
    \(\sigma\) employing an assumption of local homogeneity for
     the noncentrality parameter \(\eta\).    
Function afsigmc implements estimates from Aja-Fernandez (2009). 
    Function aflsigmc implements the estimate from Aja-Fernandez (2013)." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dti</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate noise variance for multicoil MR systems</h1>
    
    <div class="hidden name"><code>awssigmc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The distribution of image intensity values \(S_i\) divided by the noise standard deviation in \(K\)-space \(\sigma\) 
    in dMRI experiments is assumed
    to follow a non-central chi-distribution with \(2L\) degrees of freedom and noncentrality parameter \(\eta\), where \(L\) refers to the number of receiver 
    coils in the system and \(\sigma \eta\) is the signal of interest. This is an idealization in the sense that 
    each coil is assumed to have the same contribution at each location. For realistic modeling \(L\) should 
    be a locally smooth function in voxel space that reflects the varying local influence of the receiver coils in the
    the reconstruction algorithm used.</p>  
<p>The functions assume \(L\) to be known and estimate either a local 
    (function <code>awslsigmc</code>) or global ( function <code>awssigmc</code>) 
    \(\sigma\) employing an assumption of local homogeneity for
     the noncentrality parameter \(\eta\).</p>    
<p>Function <code>afsigmc</code> implements estimates from Aja-Fernandez (2009). 
    Function <code>aflsigmc</code> implements the estimate from Aja-Fernandez (2013).</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>awssigmc</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>steps</span>, mask <span class='op'>=</span> <span class='cn'>NULL</span>, ncoils <span class='op'>=</span> <span class='fl'>1</span>, vext <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, lambda <span class='op'>=</span> <span class='fl'>20</span>, 
         h0 <span class='op'>=</span> <span class='fl'>2</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>, sequence <span class='op'>=</span> <span class='cn'>FALSE</span>, hadj <span class='op'>=</span> <span class='fl'>1</span>, q <span class='op'>=</span> <span class='fl'>0.25</span>, 
         qni <span class='op'>=</span> <span class='fl'>.8</span>, method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"VAR"</span>,<span class='st'>"MAD"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>awslsigmc</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>steps</span>, mask <span class='op'>=</span> <span class='cn'>NULL</span>, ncoils <span class='op'>=</span> <span class='fl'>1</span>, vext <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, lambda <span class='op'>=</span> <span class='fl'>5</span>, minni <span class='op'>=</span> <span class='fl'>2</span>, 
         hsig <span class='op'>=</span> <span class='fl'>5</span>, sigma <span class='op'>=</span> <span class='cn'>NULL</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NCchi"</span><span class='op'>)</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>, 
         trace<span class='op'>=</span><span class='cn'>FALSE</span>, u<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>afsigmc</span><span class='op'>(</span><span class='va'>y</span>, level <span class='op'>=</span> <span class='cn'>NULL</span>, mask <span class='op'>=</span> <span class='cn'>NULL</span>,  ncoils <span class='op'>=</span> <span class='fl'>1</span>,   vext <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,   
        h <span class='op'>=</span> <span class='fl'>2</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>, hadj <span class='op'>=</span> <span class='fl'>1</span>, 
        method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"modevn"</span>,<span class='st'>"modem1chi"</span>,<span class='st'>"bkm2chi"</span>,<span class='st'>"bkm1chi"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>aflsigmc</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>ncoils</span>, level <span class='op'>=</span> <span class='cn'>NULL</span>, mask <span class='op'>=</span> <span class='cn'>NULL</span>, h<span class='op'>=</span><span class='fl'>2</span>, hadj<span class='op'>=</span><span class='fl'>1</span>,  vext <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>3D array, usually obtained from an object of class <code>dwi</code> as
    <code>obj@si[,,,i]</code> for some <code>i</code>, i.e. one 3D image from an dMRI experiment.</p></td>
    </tr>
    <tr>
      <th>steps</th>
      <td><p>number of steps in adapive weights smoothing, used to reveal the unerlying
   mean structure.</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><p>restrict computations to voxel in mask, if <code>is.null(mask)</code> all voxel are used.
   In function <code>afsigmc</code> mask should refer to background for <code>method %in% c("modem1chi","bkm2chi","bkm1chi")</code> and to voxel within the head for 
   <code>method=="modevn"</code>.</p></td>
    </tr>
    <tr>
      <th>ncoils</th>
      <td><p>number of coils, or equivalently number of effective degrees of freedom of non-central chi distribution
   divided by 2.</p></td>
    </tr>
    <tr>
      <th>vext</th>
      <td><p>voxel extentions</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>scale parameter in adaptive weights smoothing</p></td>
    </tr>
    <tr>
      <th>h0</th>
      <td><p>initial bandwidth</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if <code>verbose==TRUE</code> density plots 
   and quantiles of local estimates of <code>sigma</code> are provided.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>if <code>trace==TRUE</code> intermediate results for each step are
   returned in component tergs for all voxel in mask.</p></td>
    </tr>
    <tr>
      <th>sequence</th>
      <td><p>if <code>sequence=TRUE</code> a vector of estimates for the noise
   standard deviation <code>sigma</code> for the individual steps is returned
   instead of the final value only.</p></td>
    </tr>
    <tr>
      <th>hadj</th>
      <td><p>adjustment factor for bandwidth (chosen by <code>bw.nrd</code>) in mode estimation</p></td>
    </tr>
    <tr>
      <th>q</th>
      <td><p>quantile to be used for interquantile-differences.</p></td>
    </tr>
    <tr>
      <th>qni</th>
      <td><p>quantile of distribution of actual sum of weights \(N_i=\sum_j w_{ij}\) in adaptive smoothing. Only voxel i with \(N_i &gt; q_{qni}(N_.)\) are used for variance estimation. Should be larger than 0.5.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>in case of function <code>awssigmc</code> the
   method for variance estimation, either "VAR" (variance) or "MAD" (mean absolute deviation). In function <code>afsigmc</code> see last column in Table 2 in Aja-Fernandez (2009).</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>threshold for background separation. Used if <code>!is.null(level)</code>
   to redefine mask</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>bandwidth for local avaeraging</p></td>
    </tr>
    <tr>
      <th>minni</th>
      <td><p>Minimum sum of weights for updating values of <code>sigma</code>.</p></td>
    </tr>
    <tr>
      <th>hsig</th>
      <td><p>Bandwidth of the median filter.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>Initial estimate for <code>sigma</code></p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>One of <code>"Gauss"</code> or <code>"NCchi"</code> (default) defining the 
      probability distribution to use.</p></td>
    </tr>
    <tr>
      <th>u</th>
      <td><p>if <code>verbose==TRUE</code> an array of noncentrality paramters for
      comparisons. Internal use for tests only</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with components</p>
<dt>sigma</dt><dd><p>either a scalar or a vector of estimated noise standard deviations.</p></dd>
<dt>theta</dt><dd><p>the estimated mean structure</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>K. Tabelow, H.U. Voss, J. Polzehl, Local estimation of the noise level in MRI using structural adaptation, Medical Image Analysis, 20 (2015), pp. 76--86.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>J\"org Polzehl <a href='mailto:polzehl@wias-berlin.de'>polzehl@wias-berlin.de</a></p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Karsten Tabelow, Joerg Polzehl.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


